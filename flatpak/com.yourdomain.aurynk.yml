app-id: com.aurynk.aurynk
runtime: org.gnome.Platform
runtime-version: '48'
sdk: org.gnome.Sdk
command: aurynk

finish-args:
  # X11 + XShm access
  - --share=ipc
  - --socket=fallback-x11
  # Wayland access
  - --socket=wayland
  # Network access for ADB wireless
  - --share=network
  # Access to home directory for storing device data
  - --filesystem=home
  # System D-Bus (for notifications, etc.)
  - --socket=session-bus
  # For ADB communication
  - --device=all
  # Allow subprocess spawning (for adb commands)
  - --talk-name=org.freedesktop.Flatpak

cleanup:
  - /include
  - /lib/pkgconfig
  - /man
  - /share/doc
  - /share/gtk-doc
  - /share/man
  - /share/pkgconfig
  - '*.la'
  - '*.a'

modules:

  # Python dependencies (using direct URLs)
  - name: python3-pil
    buildsystem: simple
    build-commands:
      - pip3 install --prefix=${FLATPAK_DEST} pillow
    sources:
      - type: file
        url: https://files.pythonhosted.org/packages/5a/b0/cace85a1b0c9775a9f8f5d5423c8261c858760e2466c79b2dd184638b056/pillow-12.0.0.tar.gz
        sha256: 87d4f8125c9988bfbed67af47dd7a953e2fc7b0cc1e7800ec6d2080d490bb353

  - name: python3-qrcode
    buildsystem: simple
    build-commands:
      - pip3 install --prefix=${FLATPAK_DEST} qrcode[pil]
    sources:
      - type: file
        url: https://files.pythonhosted.org/packages/8f/b2/7fc2931bfae0af02d5f53b174e9cf701adbb35f39d69c2af63d4a39f81a9/qrcode-8.2.tar.gz
        sha256: 35c3f2a4172b33136ab9f6b3ef1c00260dd2f66f858f24d88418a015f446506c

  - name: python3-zeroconf
    buildsystem: simple
    build-commands:
      - pip3 install --prefix=${FLATPAK_DEST} zeroconf
    sources:
      - type: file
        url: https://files.pythonhosted.org/packages/67/46/10db987799629d01930176ae523f70879b63577060d63e05ebf9214aba4b/zeroconf-0.148.0.tar.gz
        sha256: 03fcca123df3652e23d945112d683d2f605f313637611b7d4adf31056f681702

  # ADB (Android Debug Bridge)
  - name: android-tools
    buildsystem: cmake-ninja
    sources:
      - type: git
        url: https://github.com/nmeum/android-tools.git
        tag: 34.0.5

  # Main application
  - name: aurynk
    buildsystem: meson
    sources:
      - type: dir
        path: .
